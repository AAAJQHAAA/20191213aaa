webpackJsonp([1],{"//Fk":function(t,n,e){t.exports={default:e("U5ju"),__esModule:!0}},"2KxR":function(t,n){t.exports=function(t,n,e,r){if(!(t instanceof n)||void 0!==r&&r in t)throw TypeError(e+": incorrect invocation!");return t}},"3fs2":function(t,n,e){var r=e("RY/4"),o=e("dSzd")("iterator"),i=e("/bQp");t.exports=e("FeBl").getIteratorMethod=function(t){if(void 0!=t)return t[o]||t["@@iterator"]||i[r(t)]}},"75j8":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("//Fk"),o=e.n(r),i=e("BO1k"),a=e.n(i),s=e("mvHQ"),c=e.n(s),u=e("2sLL"),l=e("ABCa"),f=e("rHil"),v=e("7Ah8"),h=e("Bfwr"),p=e("ihDs"),d=e("jzdL"),m=(u.a,l.a,p.a,f.a,v.a,h.a,{name:"Preset",components:{XButton:u.a,XHeader:l.a,Scroll:p.a,Group:f.a,PopupPicker:v.a,Loading:h.a},data:function(){return{voltages:[["HV"]],voltage:["HV"],tablenumbers:[["C178"]],tablenumber:["C178"],data:"",times:0,socket:"",showloading:!1}},methods:{backtoHome:function(){this.$router.push("/")},downloadTarget:function(){var t=cordova.file.externalRootDirectory+"Download/LVL-15.4-Threshhold-Parameter-20190829.csv",n=this;(new FileTransfer).download("http://alpspower.com.au/wp-content/uploads/2019/12/LVL-15.4-Threshhold-Parameter-20190829.csv",t,function(t){alert("下载成功："+t.toURL()),n.parseCSVFileToArray()},function(t){alert("下载失败："+c()(t))},!1,{headers:{Authorization:"Basic dGVzdHVzZXJuYW1lOnRlc3RwYXNzd29yZA=="}})},parseCSVFileToArray:function(){alert("下载成功之后解析文件");var t=this;window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(n){n.root.getDirectory("Download",{create:!1},function(n){n.getFile("LVL-15.4-Threshhold-Parameter-20190829.csv",{create:!1,exclusive:!1},function(n){n.file(function(n){alert("文件："+c()(n)),t.parseCsv(n)},function(t){alert("文件错误："+c()(t))})},function(t){alert("获取文件失败："+c()(t))})},function(t){})})},parseCsv:function(t){alert("解析文件");var n=this;if(window.FileReader){var e=new FileReader;e.readAsText(t),e.onload=function(t){console.log(t.target.result);var e=t.target.result.split("\r\n");console.log(e);var r=[],o=!0,i=!1,s=void 0;try{for(var c,u=a()(e);!(o=(c=u.next()).done);o=!0){var l=c.value;r.push(l.split(","))}}catch(t){i=!0,s=t}finally{try{!o&&u.return&&u.return()}finally{if(i)throw s}}console.log(r);var f=[],v=!0,h=!1,p=void 0;try{for(var d,m=a()(r);!(v=(d=m.next()).done);v=!0){var y=d.value;if(""===y[3].trim())break;f.push(parseInt(y[3])),f.push(parseInt(y[5])),f.push(parseInt(y[7])),f.push(parseInt(y[9])),f.push(parseInt(y[11])),f.push(parseInt(y[13]))}}catch(t){h=!0,p=t}finally{try{!v&&m.return&&m.return()}finally{if(h)throw p}}console.log(f);var _=[],g=!0,x=!1,w=void 0;try{for(var b,P=a()(f);!(g=(b=P.next()).done);g=!0){var k=b.value;k<0?(_.push(parseInt((65535+k)/256)),_.push((65535+k)%256)):(_.push(parseInt(k/256)),_.push(k%256))}}catch(t){x=!0,w=t}finally{try{!g&&P.return&&P.return()}finally{if(x)throw w}}console.log(_);for(var R=[],C=_.length,S=0;S<C;S+=128)R.push(_.slice(S,S+128));n.data=R,alert(n.data)}}else alert("解析文件，不支持")},startPreset:function(){var t=this;new o.a(function(n,e){t.parseCSVFileToArray(),n("解析文件成功")}).then(function(n){return console.log(n),new o.a(function(n,e){2===t.socket.state&&t.connect(),n("连接没问题")})}).then(function(n){console.log(n),t.showloading=!0,t.sendArray(0)})},connect:function(){var t=this,n=this,e=new Socket;e.open("192.168.16.254",8080,function(){alert("preset连接成功")},function(t){}),e.onData=function(e){""!=n.data&&(n.times++,n.times<t.data.length&&n.sendArray(t.times),n.times===n.data.length&&(n.showloading=!1))},e.onError=function(t){alert("preset连接期间发生错误:"+t),n.showloading=!1},e.onClose=function(t){n.showloading=!1,alert("preset连接关闭后调用")},n.socket=e},sendArray:function(t){alert("发送第"+t+"次");var n=[];n.push(1),n.push(16),n.push(4),n.push(7),n.push(0),n.push(67),n.push(134),n.push(0),n.push(parseInt((t+1)/256)),n.push((t+1)%256),n.push(0),n.push(0),n.push(0),n.push(128),128!=this.data[t].length&&(n[13]=this.data[t].length,n[5]=parseInt(n[13]/2)+3,n[6]=n[13]+6),n.push.apply(n,this.data[t]);var e=d.a.ToCRC16(n);n.push(parseInt(e.substring(0,2),16)),n.push(parseInt(e.substring(2),16)),this.socket.write(n,function(){alert("发送成功")},function(t){alert("发送失败")})}},mounted:function(){var t=this;document.addEventListener("deviceready",function(){t.connect(),t.myInterval=setInterval(function(){0===t.socket.state&&t.connect()},5e3)},!1)},destroyed:function(){2===this.socket.state&&this.socket.close(),clearInterval(this.myInterval)}}),y={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("x-header",{staticClass:"header",attrs:{"left-options":{backText:"首页",preventGoBack:!0}},on:{"on-click-back":t.backtoHome}},[t._v("预置页面")]),t._v(" "),e("scroll",{staticClass:"wrapper"},[e("group",{attrs:{title:"设置预置表参数"}},[e("popup-picker",{attrs:{title:"电压",data:t.voltages},model:{value:t.voltage,callback:function(n){t.voltage=n},expression:"voltage"}}),t._v(" "),e("popup-picker",{attrs:{title:"表格编号",data:t.tablenumbers},model:{value:t.tablenumber,callback:function(n){t.tablenumber=n},expression:"tablenumber"}}),t._v(" "),e("x-button",{attrs:{type:"primary"},nativeOn:{click:function(n){return t.connect(n)}}},[t._v("连接")]),t._v(" "),e("x-button",{attrs:{type:"primary"},nativeOn:{click:function(n){return t.downloadTarget(n)}}},[t._v("下载CSV文件")]),t._v(" "),e("x-button",{attrs:{type:"primary"},nativeOn:{click:function(n){return t.parseCSVFileToArray(n)}}},[t._v("解析文件")]),t._v(" "),e("x-button",{attrs:{type:"primary",disabled:""===t.data},nativeOn:{click:function(n){return t.startPreset(n)}}},[t._v("写设备参数")]),t._v(" "),e("x-button",{attrs:{type:"primary"},nativeOn:{click:function(n){return t.connect(n)}}},[t._v("连接")])],1),t._v(" "),e("div",[e("loading",{attrs:{show:t.showloading,text:"updata"}})],1)],1)],1)},staticRenderFns:[]};var _=e("VU/8")(m,y,!1,function(t){e("uCu5")},"data-v-036035a2",null);n.default=_.exports},"82Mu":function(t,n,e){var r=e("7KvD"),o=e("L42u").set,i=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,c="process"==e("R9M2")(a);t.exports=function(){var t,n,e,u=function(){var r,o;for(c&&(r=a.domain)&&r.exit();t;){o=t.fn,t=t.next;try{o()}catch(r){throw t?e():n=void 0,r}}n=void 0,r&&r.enter()};if(c)e=function(){a.nextTick(u)};else if(!i||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);e=function(){l.then(u)}}else e=function(){o.call(r,u)};else{var f=!0,v=document.createTextNode("");new i(u).observe(v,{characterData:!0}),e=function(){v.data=f=!f}}return function(r){var o={fn:r,next:void 0};n&&(n.next=o),t||(t=o,e()),n=o}}},BO1k:function(t,n,e){t.exports={default:e("fxRn"),__esModule:!0}},Bfwr:function(t,n,e){"use strict";Boolean,String,String,String;var r={name:"loading",model:{prop:"show",event:"change"},props:{show:Boolean,text:String,position:String,transition:{type:String,default:"vux-mask"}},watch:{show:function(t){this.$emit("update:show",t)}}},o={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("transition",{attrs:{name:t.transition}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"weui-loading_toast vux-loading",class:t.text?"":"vux-loading-no-text"},[e("div",{staticClass:"weui-mask_transparent"}),t._v(" "),e("div",{staticClass:"weui-toast",style:{position:t.position}},[e("i",{staticClass:"weui-loading weui-icon_toast"}),t._v(" "),t.text?e("p",{staticClass:"weui-toast__content"},[t._v(t._s(t.text||"加载中")),t._t("default")],2):t._e()])])])},staticRenderFns:[]};var i=e("VU/8")(r,o,!1,function(t){e("t+oN")},null,null);n.a=i.exports},CXw9:function(t,n,e){"use strict";var r,o,i,a,s=e("O4g8"),c=e("7KvD"),u=e("+ZMJ"),l=e("RY/4"),f=e("kM2E"),v=e("EqjI"),h=e("lOnJ"),p=e("2KxR"),d=e("NWt+"),m=e("t8x9"),y=e("L42u").set,_=e("82Mu")(),g=e("qARP"),x=e("dNDb"),w=e("iUbK"),b=e("fJUb"),P=c.TypeError,k=c.process,R=k&&k.versions,C=R&&R.v8||"",S=c.Promise,j="process"==l(k),M=function(){},T=o=g.f,F=!!function(){try{var t=S.resolve(1),n=(t.constructor={})[e("dSzd")("species")]=function(t){t(M,M)};return(j||"function"==typeof PromiseRejectionEvent)&&t.then(M)instanceof n&&0!==C.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(t){}}(),E=function(t){var n;return!(!v(t)||"function"!=typeof(n=t.then))&&n},A=function(t,n){if(!t._n){t._n=!0;var e=t._c;_(function(){for(var r=t._v,o=1==t._s,i=0,a=function(n){var e,i,a,s=o?n.ok:n.fail,c=n.resolve,u=n.reject,l=n.domain;try{s?(o||(2==t._h&&B(t),t._h=1),!0===s?e=r:(l&&l.enter(),e=s(r),l&&(l.exit(),a=!0)),e===n.promise?u(P("Promise-chain cycle")):(i=E(e))?i.call(e,c,u):c(e)):u(r)}catch(t){l&&!a&&l.exit(),u(t)}};e.length>i;)a(e[i++]);t._c=[],t._n=!1,n&&!t._h&&I(t)})}},I=function(t){y.call(c,function(){var n,e,r,o=t._v,i=O(t);if(i&&(n=x(function(){j?k.emit("unhandledRejection",o,t):(e=c.onunhandledrejection)?e({promise:t,reason:o}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",o)}),t._h=j||O(t)?2:1),t._a=void 0,i&&n.e)throw n.v})},O=function(t){return 1!==t._h&&0===(t._a||t._c).length},B=function(t){y.call(c,function(){var n;j?k.emit("rejectionHandled",t):(n=c.onrejectionhandled)&&n({promise:t,reason:t._v})})},L=function(t){var n=this;n._d||(n._d=!0,(n=n._w||n)._v=t,n._s=2,n._a||(n._a=n._c.slice()),A(n,!0))},D=function(t){var n,e=this;if(!e._d){e._d=!0,e=e._w||e;try{if(e===t)throw P("Promise can't be resolved itself");(n=E(t))?_(function(){var r={_w:e,_d:!1};try{n.call(t,u(D,r,1),u(L,r,1))}catch(t){L.call(r,t)}}):(e._v=t,e._s=1,A(e,!1))}catch(t){L.call({_w:e,_d:!1},t)}}};F||(S=function(t){p(this,S,"Promise","_h"),h(t),r.call(this);try{t(u(D,this,1),u(L,this,1))}catch(t){L.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=e("xH/j")(S.prototype,{then:function(t,n){var e=T(m(this,S));return e.ok="function"!=typeof t||t,e.fail="function"==typeof n&&n,e.domain=j?k.domain:void 0,this._c.push(e),this._a&&this._a.push(e),this._s&&A(this,!1),e.promise},catch:function(t){return this.then(void 0,t)}}),i=function(){var t=new r;this.promise=t,this.resolve=u(D,t,1),this.reject=u(L,t,1)},g.f=T=function(t){return t===S||t===a?new i(t):o(t)}),f(f.G+f.W+f.F*!F,{Promise:S}),e("e6n0")(S,"Promise"),e("bRrM")("Promise"),a=e("FeBl").Promise,f(f.S+f.F*!F,"Promise",{reject:function(t){var n=T(this);return(0,n.reject)(t),n.promise}}),f(f.S+f.F*(s||!F),"Promise",{resolve:function(t){return b(s&&this===a?S:this,t)}}),f(f.S+f.F*!(F&&e("dY0y")(function(t){S.all(t).catch(M)})),"Promise",{all:function(t){var n=this,e=T(n),r=e.resolve,o=e.reject,i=x(function(){var e=[],i=0,a=1;d(t,!1,function(t){var s=i++,c=!1;e.push(void 0),a++,n.resolve(t).then(function(t){c||(c=!0,e[s]=t,--a||r(e))},o)}),--a||r(e)});return i.e&&o(i.v),e.promise},race:function(t){var n=this,e=T(n),r=e.reject,o=x(function(){d(t,!1,function(t){n.resolve(t).then(e.resolve,r)})});return o.e&&r(o.v),e.promise}})},EqBC:function(t,n,e){"use strict";var r=e("kM2E"),o=e("FeBl"),i=e("7KvD"),a=e("t8x9"),s=e("fJUb");r(r.P+r.R,"Promise",{finally:function(t){var n=a(this,o.Promise||i.Promise),e="function"==typeof t;return this.then(e?function(e){return s(n,t()).then(function(){return e})}:t,e?function(e){return s(n,t()).then(function(){throw e})}:t)}})},L42u:function(t,n,e){var r,o,i,a=e("+ZMJ"),s=e("knuC"),c=e("RPLV"),u=e("ON07"),l=e("7KvD"),f=l.process,v=l.setImmediate,h=l.clearImmediate,p=l.MessageChannel,d=l.Dispatch,m=0,y={},_=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},g=function(t){_.call(t.data)};v&&h||(v=function(t){for(var n=[],e=1;arguments.length>e;)n.push(arguments[e++]);return y[++m]=function(){s("function"==typeof t?t:Function(t),n)},r(m),m},h=function(t){delete y[t]},"process"==e("R9M2")(f)?r=function(t){f.nextTick(a(_,t,1))}:d&&d.now?r=function(t){d.now(a(_,t,1))}:p?(i=(o=new p).port2,o.port1.onmessage=g,r=a(i.postMessage,i,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(t){l.postMessage(t+"","*")},l.addEventListener("message",g,!1)):r="onreadystatechange"in u("script")?function(t){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),_.call(t)}}:function(t){setTimeout(a(_,t,1),0)}),t.exports={set:v,clear:h}},Mhyx:function(t,n,e){var r=e("/bQp"),o=e("dSzd")("iterator"),i=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||i[o]===t)}},"NWt+":function(t,n,e){var r=e("+ZMJ"),o=e("msXi"),i=e("Mhyx"),a=e("77Pl"),s=e("QRG4"),c=e("3fs2"),u={},l={};(n=t.exports=function(t,n,e,f,v){var h,p,d,m,y=v?function(){return t}:c(t),_=r(e,f,n?2:1),g=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(i(y)){for(h=s(t.length);h>g;g++)if((m=n?_(a(p=t[g])[0],p[1]):_(t[g]))===u||m===l)return m}else for(d=y.call(t);!(p=d.next()).done;)if((m=o(d,_,p.value,n))===u||m===l)return m}).BREAK=u,n.RETURN=l},"RY/4":function(t,n,e){var r=e("R9M2"),o=e("dSzd")("toStringTag"),i="Arguments"==r(function(){return arguments}());t.exports=function(t){var n,e,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=function(t,n){try{return t[n]}catch(t){}}(n=Object(t),o))?e:i?r(n):"Object"==(a=r(n))&&"function"==typeof n.callee?"Arguments":a}},U5ju:function(t,n,e){e("M6a0"),e("zQR9"),e("+tPU"),e("CXw9"),e("EqBC"),e("jKW+"),t.exports=e("FeBl").Promise},bRrM:function(t,n,e){"use strict";var r=e("7KvD"),o=e("FeBl"),i=e("evD5"),a=e("+E39"),s=e("dSzd")("species");t.exports=function(t){var n="function"==typeof o[t]?o[t]:r[t];a&&n&&!n[s]&&i.f(n,s,{configurable:!0,get:function(){return this}})}},dNDb:function(t,n){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},dY0y:function(t,n,e){var r=e("dSzd")("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(t){}t.exports=function(t,n){if(!n&&!o)return!1;var e=!1;try{var i=[7],a=i[r]();a.next=function(){return{done:e=!0}},i[r]=function(){return a},t(i)}catch(t){}return e}},fJUb:function(t,n,e){var r=e("77Pl"),o=e("EqjI"),i=e("qARP");t.exports=function(t,n){if(r(t),o(n)&&n.constructor===t)return n;var e=i.f(t);return(0,e.resolve)(n),e.promise}},fxRn:function(t,n,e){e("+tPU"),e("zQR9"),t.exports=e("g8Ux")},g8Ux:function(t,n,e){var r=e("77Pl"),o=e("3fs2");t.exports=e("FeBl").getIterator=function(t){var n=o(t);if("function"!=typeof n)throw TypeError(t+" is not iterable!");return r(n.call(t))}},iUbK:function(t,n,e){var r=e("7KvD").navigator;t.exports=r&&r.userAgent||""},"jKW+":function(t,n,e){"use strict";var r=e("kM2E"),o=e("qARP"),i=e("dNDb");r(r.S,"Promise",{try:function(t){var n=o.f(this),e=i(t);return(e.e?n.reject:n.resolve)(e.v),n.promise}})},knuC:function(t,n){t.exports=function(t,n,e){var r=void 0===e;switch(n.length){case 0:return r?t():t.call(e);case 1:return r?t(n[0]):t.call(e,n[0]);case 2:return r?t(n[0],n[1]):t.call(e,n[0],n[1]);case 3:return r?t(n[0],n[1],n[2]):t.call(e,n[0],n[1],n[2]);case 4:return r?t(n[0],n[1],n[2],n[3]):t.call(e,n[0],n[1],n[2],n[3])}return t.apply(e,n)}},msXi:function(t,n,e){var r=e("77Pl");t.exports=function(t,n,e,o){try{return o?n(r(e)[0],e[1]):n(e)}catch(n){var i=t.return;throw void 0!==i&&r(i.call(t)),n}}},qARP:function(t,n,e){"use strict";var r=e("lOnJ");t.exports.f=function(t){return new function(t){var n,e;this.promise=new t(function(t,r){if(void 0!==n||void 0!==e)throw TypeError("Bad Promise constructor");n=t,e=r}),this.resolve=r(n),this.reject=r(e)}(t)}},"t+oN":function(t,n){},t8x9:function(t,n,e){var r=e("77Pl"),o=e("lOnJ"),i=e("dSzd")("species");t.exports=function(t,n){var e,a=r(t).constructor;return void 0===a||void 0==(e=r(a)[i])?n:o(e)}},uCu5:function(t,n){},"xH/j":function(t,n,e){var r=e("hJx8");t.exports=function(t,n,e){for(var o in n)e&&t[o]?t[o]=n[o]:r(t,o,n[o]);return t}}});
//# sourceMappingURL=1.6d892d305d4ed5db1608.js.map